<!DOCTYPE html>
<html lang="en>
<head>
	<meta charset="utf-8">
		<meta name="viewport" content="width=device-width", initial scale="1.0">
	<link rel="stylesheet" href="styles.css">
	<title></title>
</head>
<body>
	<script type="text/javascript">
		//Defining statecodes for each state
		var ranges=
		{
			'100':"Andhra Pradesh", '101':"Arunachal Pradesh", '102':"Assam", '103':"Meghalaya", '104':"Bihar", '105':"Chhattisgarh", '106':"Goa", '107':"Himachal Pradesh", '108':"Haryana",  '109':"Jharkhand", '110':"Karnataka", '111':"Madhya Pradesh", '112':"Maharashtra", '113':"Manipur", '114':"Gujarat", '115':"	Kerala", '116':"Mizoram", '117':"Nagaland", '118':"Odisha", '119':"Rajasthan", '120':"Sikkim", '121':"Tamil Nadu", '122':"Punjab", '123':"Telangana", '124':"Tripura", '125':"Uttar Pradesh", '126':"Uttarakhand", '127':"West Bengal", '128':"Andaman and Nicobar Islands", '129':"Chandigarh", '130':"Dadra & Nagar Haveli", '131':"Delhi", '132':"Jammu and Kashmir", '133':"Lakshadweep", '134':"Puducherry", '135':"Ladakh", '136':"Daman & Diu"
		}
		
		//Name validation	
		function nameFunc()
		{
			var name= document.getElementById("name").value;
			localStorage.setItem("txtValue", name);//for use in verification page

			var allowed_format = /^[a-zA-Z]+ [a-zA-Z]+$/;  // /^[a-zA-Z\s]+$/; //regex for accepting only [A-Z][a-z].
			
			if (name == "") 
			{
				alert("Name can’t be blank or empty !!!");
			    return false;
			}
			if (name.length<4)
			{
				alert("Minimum 4 characters required");
				return false;
			}
			if (name.match(allowed_format))
			{
				return true;	
			}
			else
			{
				alert("Only Alphabets allowed [A-Z][a-z] with firstname and lastname");
				return false;
			}
		}


		//emailFunc used for validating email input.
		function emailFunc()//not working properly.
		{
			var email=document.getElementById("email").value;

			if (email === "") 
			{
				alert("email can’t be blank or empty !!!");
			    return false;
			}
			else
			{
				return true;
			}

		}

		//Phone validation
		function phoneFunc() 
		{
			var inpField = document.getElementById("phone");
			var inputno=document.getElementById("phone").value;//used it for creating substring to find operator and state.
			localStorage.setItem("txtValue2", inputno);//for use in verification page.
			var l = inpField.value.length;
			var key = event.inputType;


			//creating operator substring and saved it to localStorage.
			var operator=inputno.substring(1, 4);
			localStorage.setItem("operator", operator);


			//creating state substring and saved it to localStorage.
			var state=inputno.substring(6, 9);
			localStorage.setItem("state", state);
			
			

			  //checking the inputs to add the required pattern.
			switch (l) {
			  case 1:
			    inpField.value = "(" + inpField.value;
			    break
			  case 4:
			    inpField.value = inpField.value + ") ";
			    break
			  case 9:
			    inpField.value = inpField.value + " - ";
		        break
	   		  case 17:
		        // prevents user from typing more numbers than necessary:
			    inpField.value = inpField.value.slice(0, l - 1);

			}
			
			//Validating and finding correct Phone operator and printing them
		
			if(operator>=621 && operator!=800)
			{
				if(operator<=799 && operator>=621)
				{
					document.getElementById("phone_message").innerHTML="Reliance Jio,";
				
				}
				if(operator<=920 && operator>=801)
				{
					document.getElementById("phone_message").innerHTML="Idea,";

				}
				if(operator<=999 && operator>=921)
				{
					document.getElementById("phone_message").innerHTML="Vodafone,";
				}

			}
			else if((operator<=620 || operator==800) && operator.length>=3)
			{
				alert("Invalid number");
				document.getElementById('phone').value="";
				return false;
				//document.getElementById("phone").value='';
				
			}
			
			var token=0;//using token concept for the loop
			while(token==0 && state.length>2)
			{
				if(state.length>2)
				{
					document.getElementById("statecode").innerHTML=(ranges[state]);
					if(ranges[state]!==undefined)
					{
						token+=1;
						return true;
					}
				}
				if(token!=1)
				{
					alert("Invalid state");
					//document.getElementById('Form').reset();
					document.getElementById('phone').value="";
					return false;
				}
				

			}
			
			
			
		}
		
		
		
		function generateOTP() {
		          
		    // Declare a digits variable 
		    // which stores all digits
		    var digits = '0123456789';
		    let OTP = '';
		    for (let i = 0; i < 4; i++ ) {
		        OTP += digits[Math.floor(Math.random() * 10)];
		    }
		    localStorage.setItem("otp", OTP);
		    
		    return OTP;
		    
		}
		generateOTP();
		//document.write("OTP of 4 digits: ")
		//document.write( generateOTP() );
		//localStorage.clear();
		function clear()
		{
			document.getElementById('phone').value="";
		}


		
	</script>
	<form id="Form" action="verification.html" onsubmit="return nameFunc()" method="GET">
		<div><p><h1>OTP Form</h1></p></div>
		<div>
			<br>
			<label>Name</label>
			<input type="text" id="name" name="name" required>
			<span id="name_message"> </span>
			<br><br>
		

			<label for="email">Email</label>
			<input type="email" id="email" name="email" oninput="emailFunc()"  value="" required>
			<span id="email_message"> </span>
			<br><br>
		

			<label>Phone</label>
			<input type="tel" id="phone" oninput="phoneFunc()" placeholder="(###) ### - ####" required pattern="\([0-9]{3}\) [0-9]{3} - [0-9]{4}" required>
			<br>
			<span id="phone_message"></span>
			<span id="statecode"></span>	
			<br>
		</div>
			<input type="submit" onsubmit="return generateOTP()" value="Submit">
			<span id="otpshow"></span>
	</form>


</body>
</html>
